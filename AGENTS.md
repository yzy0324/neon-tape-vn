# AGENTS.md

本文件是 **neon-tape-vn** 仓库的永久工程规范，作用域覆盖仓库根目录及其全部子目录。

## 1) 项目定位与运行方式
- 项目类型必须保持为：**纯静态 Web（HTML/CSS/JS）**。
- 必须可直接通过以下命令运行（不得要求额外后端框架）：
  - `python -m http.server 8000`
- `README.md` 必须始终提供最新、可执行的本地运行说明。

## 2) 视觉与可读性规范
- 视觉风格：磁带未来主义 / 太阳复古（neon、scanline、grain、VHS、玻璃拟态）。
- 在任何风格化效果下，**可读性优先**：
  - 正文与背景要有足够对比度；
  - 交互元素在移动端与桌面端均可辨识；
  - 避免因为特效导致关键信息不可读。

## 3) 游戏结构（视觉小说引擎）
- 使用 **scene 数据驱动** 的结构组织剧情。
- 引擎必须支持：
  - 对话
  - 旁白
  - 角色立绘切换
  - 背景切换
  - 选项分支
  - 跳转
  - 条件判断

## 4) 多结局与倾向系统
- 游戏必须提供 **至少 3 个结局**。
- 结局判定必须基于以下 3 组倾向记录：
  - 理性 / 感性
  - 合作 / 对抗
  - 探索 / 保守
- 倾向值必须有可视化展示（如进度条、雷达图、刻度条等）。

## 5) 存档与读档
- 存档介质必须为 `localStorage`。
- 必须提供：
  - 至少 3 个手动存档槽
  - 1 个自动存档
- 存档内容至少包含：
  - 当前节点
  - 倾向值
  - 剧情日志
  - BGM 状态

## 6) BGM 规范
- 不得依赖外链音频资源。
- 优先使用 WebAudio 合成；或使用仓库内本地音频（如 `assets/bgm/`）。
- 必须提供 BGM 开关。
- 必须处理“用户交互后才能播放音频”的浏览器限制（如 `AudioContext.resume()`）。

## 7) 角色美术规范
- 每个角色必须提供像素风赛博朋克立绘。
- 可使用 SVG 像素块或 Canvas 生成占位立绘，后续可替换为 PNG。
- 必须为立绘定义统一：
  - 渲染尺寸
  - 调色板（palette）

## 8) 工程与代码组织
- 所有业务逻辑必须拆分到 `js/` 目录。
- 禁止把大段脚本（数百行）集中在单个 HTML 内联 `<script>` 中。
- 资源建议按职责组织：
  - `js/`：引擎、数据、存档、音频、渲染
  - `assets/`：图片、音频等静态资源
  - `scripts/`：自检与辅助脚本

## 9) 每次修改的强制要求
- **每次修改都必须同步更新或新增测试/自检脚本**，至少覆盖以下检查项：
  - 关键字符串存在
  - 场景数量达到阈值
  - 多结局存在
  - 存档键存在
- 推荐将自检脚本放在 `scripts/` 并确保命令可直接执行。

## 10) 变更交付要求
- 提交变更时应：
  - 更新相关文档（至少 README 的运行方式与新增命令）
  - 执行并记录自检结果
  - 确保静态站点可通过 `python -m http.server` 打开

