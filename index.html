<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>霓虹磁带：夜航调酒录</title>
    <link rel="stylesheet" href="css/ui.css" />

</head>
<body>
  <div class="sun"></div><div class="grid"></div>
  <main class="app">
    <aside class="left">
      <div class="cassette"><h2>NEON TAPE_017</h2><div class="tiny">身份：夜航调酒师 / 情报中继员「零磁」</div></div>
      <div class="portrait-wrap"><img id="portrait" class="portrait" alt="角色像素立绘" /></div>
      <div id="charInfo" class="tiny"></div>
      <div id="routeHint" class="tiny">路线趋近提示：尚未开始。</div>
      <div class="ui-toggles" aria-label="移动端显示设置">
        <label><input id="hidePortraitToggle" type="checkbox" />隐藏立绘</label>
        <label><input id="compactUiToggle" type="checkbox" />缩小UI</label>
      </div>
      <div class="stats">
        <div>理性 ↔ 感性<div class="bar"><span id="barLogic"></span></div></div>
        <div>合作 ↔ 对抗<div class="bar"><span id="barCoop"></span></div></div>
        <div>探索 ↔ 保守<div class="bar"><span id="barExplore"></span></div></div>
      </div>
      <div id="routeForecast" class="forecast">终章预测：尚未进入预测窗口。</div>
      <div class="route-diagnosis">
        <div class="tiny">路线诊断（最近 8 次选择）</div>
        <div id="routeDiagnosisList" class="diag-list"></div>
      </div>
      <div class="tiny">剧情日志（可回看）</div>
      <div id="logPanel" class="log"></div>
      <div class="controls">
        <button id="savePanelBtn" aria-label="打开磁带存档面板">磁带存档面板</button><button id="archivePanelBtn" aria-label="打开线索板和档案">线索板/档案</button>
        <button id="endingPanelBtn" aria-label="打开结局档案馆">结局档案馆</button>
        <button id="bgmBtn" aria-label="切换音频总线">开启音频总线</button>
        <button id="resetBtn" aria-label="重开当前流程">重开本局</button><button data-load="auto" aria-label="读取自动存档">读取自动存档</button>
        <div id="audioUnlockHint" class="audio-unlock" aria-live="polite">
          音频尚未解锁：浏览器需要一次用户交互后才能播放。
          <button id="audioUnlockBtn" aria-label="通过用户交互解锁音频播放">点击开启音频</button>
        </div>
      </div>
    </aside>
    <section class="right">
      <div class="scene-head"><strong id="sceneTitle">序章</strong><span id="clock">22:11 / 雨夜</span><div class="playback-controls"><button id="showAllBtn" aria-label="立即显示当前全文">全文</button><button id="autoBtn" aria-label="切换自动播放">Auto</button><button id="skipBtn" aria-label="切换已读跳过">Skip</button><button id="historyBtn" aria-label="打开历史回放面板">History</button></div></div>
      <div class="bg-layer" id="bgLayer"></div>
      <div id="story" class="story"></div>
      <div id="choices" class="choices"></div>
    </section>
  </main>

  <div class="save-panel" id="savePanel" aria-hidden="true">
    <section class="save-shell">
      <div class="save-head">
        <strong>📼 Tape Archive / 存档总线</strong>
        <button id="savePanelClose" aria-label="关闭存档面板">关闭</button>
      </div>
      <div class="slots">
        <div class="slot"><h4>Slot1</h4><div class="row"><button data-save="slot1" aria-label="保存到存档槽1">保存</button><button data-load="slot1" aria-label="读取存档槽1">读取</button><button data-export="slot1" aria-label="导出存档槽1">导出</button><button data-import="slot1" aria-label="导入到存档槽1">导入</button></div></div>
        <div class="slot"><h4>Slot2</h4><div class="row"><button data-save="slot2" aria-label="保存到存档槽2">保存</button><button data-load="slot2" aria-label="读取存档槽2">读取</button><button data-export="slot2" aria-label="导出存档槽2">导出</button><button data-import="slot2" aria-label="导入到存档槽2">导入</button></div></div>
        <div class="slot"><h4>Slot3</h4><div class="row"><button data-save="slot3" aria-label="保存到存档槽3">保存</button><button data-load="slot3" aria-label="读取存档槽3">读取</button><button data-export="slot3" aria-label="导出存档槽3">导出</button><button data-import="slot3" aria-label="导入到存档槽3">导入</button></div></div>
        <div class="slot"><h4>Auto</h4><div class="row"><button data-save="auto" aria-label="保存到自动存档槽">保存</button><button data-load="auto" aria-label="读取自动存档槽">读取</button><button data-export="auto" aria-label="导出自动存档槽">导出</button><button data-import="auto" aria-label="导入到自动存档槽">导入</button></div></div>
        <div class="volume-wrap">
          <div class="tiny">主音量：<span id="masterVolumeLabel">72%</span></div>
          <input id="masterVolume" type="range" min="0" max="100" step="1" value="72" />
          <div class="audio-grid">
            <div class="audio-row">
              <label><input id="musicToggle" type="checkbox" checked />music</label>
              <input id="musicVolume" type="range" min="0" max="100" step="1" value="55" />
              <span id="musicVolumeLabel">55%</span>
            </div>
            <div class="audio-row">
              <label><input id="ambienceToggle" type="checkbox" checked />ambience</label>
              <input id="ambienceVolume" type="range" min="0" max="100" step="1" value="48" />
              <span id="ambienceVolumeLabel">48%</span>
            </div>
            <div class="audio-row">
              <label><input id="sfxToggle" type="checkbox" checked />sfx</label>
              <input id="sfxVolume" type="range" min="0" max="100" step="1" value="65" />
              <span id="sfxVolumeLabel">65%</span>
            </div>
          </div>
          <div class="tiny">music 快捷音量：<span id="bgmVolumeLabel">55%</span></div>
          <input id="bgmVolume" type="range" min="0" max="100" step="1" value="55" />
        </div>
      </div>
      <div class="transfer">
        <div class="tiny">导出将尝试复制到剪贴板；导入前请粘贴完整 JSON（包含 schemaVersion）。</div>
        <textarea id="saveTransferText" placeholder="在此粘贴或查看存档 JSON"></textarea>
        <div id="saveStatus" class="status"></div>
      </div>
    </section>
  </div>

  <div class="archive-panel" id="archivePanel" aria-hidden="true">
    <section class="archive-shell">
      <div class="save-head">
        <strong>🧷 线索板 / 档案</strong>
        <button id="archivePanelClose" aria-label="关闭线索档案面板">关闭</button>
      </div>
      <div id="archiveBody" class="archive-body"></div>
    </section>
  </div>

  <div class="archive-panel" id="endingPanel" aria-hidden="true">
    <section class="archive-shell">
      <div class="save-head">
        <strong>🏁 结局档案馆</strong>
        <button id="endingPanelClose" aria-label="关闭结局档案面板">关闭</button>
      </div>
      <div id="endingBody" class="archive-body"></div>
    </section>
  </div>

  <div class="history-panel" id="historyPanel" aria-hidden="true">
    <div class="head">
      <strong>🕘 历史回放（最近 40 条）</strong>
      <button id="historyClose" aria-label="关闭历史回放">关闭</button>
    </div>
    <div id="historyBody" class="body"></div>
  </div>
  <script type="module" src="js/main.js"></script>
</body>
</html>
